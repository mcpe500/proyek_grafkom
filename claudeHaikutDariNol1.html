<!DOCTYPE html>
<html lang="en">
  <head>
    <title>three.js - Pointer Lock Controls with WASD and Mouse</title>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"
    />
    <script type="importmap">
      {
        "imports": {
          "three": "https://cdn.jsdelivr.net/npm/three@0.132.2/build/three.module.js",
          "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.132.2/examples/jsm/"
        }
      }
    </script>
    <style>
      body {
        margin: 0;
        padding: 0;
        overflow: hidden;
      }
    </style>
  </head>
  <body>
    <script type="module">
      import * as THREE from "three";
      import { GLTFLoader } from "three/addons/loaders/GLTFLoader.js";

      // Create the scene, camera, and renderer
      const scene = new THREE.Scene();
      const camera = new THREE.PerspectiveCamera(
        75,
        window.innerWidth / window.innerHeight,
        0.1,
        1000
      );
      const renderer = new THREE.WebGLRenderer({
        canvas: document.createElement("canvas"),
        antialias: true,
      });
      renderer.setSize(window.innerWidth, window.innerHeight);
      document.body.appendChild(renderer.domElement);

      // Load the Pikachu model
      const loader = new GLTFLoader();
      loader.load("./pikachu.glb", (gltf) => {
        const model = gltf.scene;
        scene.add(model);
      });

      // Add some basic lighting
      const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
      scene.add(ambientLight);
      const pointLight = new THREE.PointLight(0xffffff, 1, 100);
      pointLight.position.set(5, 5, 5);
      scene.add(pointLight);

      // Add WASD and mouse movement controls
      let moveForward = false;
      let moveBackward = false;
      let moveLeft = false;
      let moveRight = false;
      let rotateLeft = false;
      let rotateRight = false;

      document.addEventListener("keydown", (event) => {
        switch (event.key) {
          case "w":
            moveForward = true;
            break;
          case "s":
            moveBackward = true;
            break;
          case "a":
            moveLeft = true;
            break;
          case "d":
            moveRight = true;
            break;
        }
      });

      document.addEventListener("keyup", (event) => {
        switch (event.key) {
          case "w":
            moveForward = false;
            break;
          case "s":
            moveBackward = false;
            break;
          case "a":
            moveLeft = false;
            break;
          case "d":
            moveRight = false;
            break;
        }
      });

      document.addEventListener("mousemove", (event) => {
        const mouseX = event.clientX;
        const mouseY = event.clientY;
        const rotateSpeed = 0.005;

        if (mouseX < window.innerWidth / 2) {
          rotateLeft = true;
        } else if (mouseX > window.innerWidth / 2) {
          rotateRight = true;
        } else {
          rotateLeft = false;
          rotateRight = false;
        }

        if (mouseY < window.innerHeight / 2) {
          camera.position.y += rotateSpeed;
        } else if (mouseY > window.innerHeight / 2) {
          camera.position.y -= rotateSpeed;
        }
      });

      function animate() {
        requestAnimationFrame(animate);

        if (moveForward) {
          camera.position.z -= 0.1;
        }
        if (moveBackward) {
          camera.position.z += 0.1;
        }
        if (moveLeft) {
          camera.position.x -= 0.1;
        }
        if (moveRight) {
          camera.position.x += 0.1;
        }
        if (rotateLeft) {
          camera.rotation.y -= 0.01;
        }
        if (rotateRight) {
          camera.rotation.y += 0.01;
        }

        renderer.render(scene, camera);
      }

      animate();
    </script>
  </body>
</html>
